alerts:
- rule: DEPLOYMENT_FAILED
- rule: DOMAIN_FAILED
domains:
- domain: taxskyai.com
  type: PRIMARY
  zone: taxskyai.com
features:
- buildpack-stack=ubuntu-22
ingress:
  rules:
  - component:
      name: taxsky-python
    match:
      path:
        prefix: /python
  - component:
      name: taxsky-ai-frontend
    match:
      path:
        prefix: /
  - component:
      name: taxsky-ai
      preserve_path_prefix: true
    match:
      path:
        prefix: /api
  - component:
      name: taxsky-ai
      preserve_path_prefix: true
    match:
      path:
        prefix: /health
name: taxskyai
region: sfo
services:
- environment_slug: node-js
  envs:
  - key: PORT
    scope: RUN_AND_BUILD_TIME
    value: "8080"
  - key: NODE_ENV
    scope: RUN_AND_BUILD_TIME
    value: production
  - key: GOOGLE_CLIENT_ID
    scope: RUN_AND_BUILD_TIME
    value: 393943458160-j4ngokg84ehma84ukf0q05ov47993uem.apps.googleusercontent.com
  - key: GOOGLE_CLIENT_SECRET
    scope: RUN_AND_BUILD_TIME
    value: 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
  - key: JWT_SECRET
    scope: RUN_AND_BUILD_TIME
    value: taxsky-jwt-secret-2024-bestskyamerican-random-key
  - key: JWT_EXPIRES_IN
    scope: RUN_AND_BUILD_TIME
    value: 7d
  - key: STRIPE_SECRET_KEY
    scope: RUN_AND_BUILD_TIME
    value: sk_test_51PI8WZCX6s8rem74RIngl3tBDRn4kU7B4b4Qjm5NW7gcfYrS7toMnXDE2PMd7cLLXsR2jcT6qxzs5ErYAijBONt200rEkVb8Wg
  - key: MONGODB_URI
    scope: RUN_AND_BUILD_TIME
    value: mongodb+srv://doadmin:9mb0I2r13P485ETp@db-mongodb-nyc3-29782-5b577e4b.mongo.ondigitalocean.com/ai_tax?authSource=admin&tls=true
  - key: OPENAI_API_KEY
    scope: RUN_AND_BUILD_TIME
    value: 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
  - key: OPENAI_PROMPT_ID
    scope: RUN_AND_BUILD_TIME
    value: pmpt_6959ca4bb4c08194ae6c2011952c7bce06d67339e52d2b77
  - key: OPENAI_PROMPT_VERSION
    scope: RUN_AND_BUILD_TIME
    value: "22"
  - key: FRONTEND_URL
    scope: RUN_AND_BUILD_TIME
    value: https://taxskyai.com
  - key: PYTHON_TAX_API
    scope: RUN_AND_BUILD_TIME
    value: https://taxskyai.com/python
  github:
    branch: main
    deploy_on_push: true
    repo: bestskyamerican/taxsky_ai
  http_port: 8080
  instance_count: 1
  instance_size_slug: apps-s-1vcpu-0.5gb
  name: taxsky-ai
  run_command: npm start
  source_dir: /backend
- build_command: pip install -r requirements.txt
  environment_slug: python
  envs:
  - key: OPENAI_API_KEY
    scope: RUN_AND_BUILD_TIME
    value: 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
  - key: MONGODB_URI
    scope: RUN_AND_BUILD_TIME
    value: mongodb+srv://doadmin:9mb0I2r13P485ETp@db-mongodb-nyc3-29782-5b577e4b.mongo.ondigitalocean.com/ai_tax?authSource=admin&tls=true
  - key: NODE_API_URL
    scope: RUN_AND_BUILD_TIME
    value: https://goldfish-app-3qzug.ondigitalocean.app
  github:
    branch: main
    deploy_on_push: true
    repo: bestskyamerican/taxsky_ai
  http_port: 5002
  instance_count: 1
  instance_size_slug: apps-s-1vcpu-0.5gb
  name: taxsky-python
  run_command: uvicorn main:app --host 0.0.0.0 --port 5002
  source_dir: /python_service
static_sites:
- build_command: npm run build
  catchall_document: index.html
  environment_slug: node-js
  envs:
  - key: VITE_API_URL
    scope: BUILD_TIME
    value: https://taxskyai.com
  - key: VITE_PYTHON_API
    scope: BUILD_TIME
    value: https://taxskyai.com/python
  - key: VITE_GOOGLE_CLIENT_ID
    scope: BUILD_TIME
    value: 393943458160-j4ngokg84ehma84ukf0q05ov47993uem.apps.googleusercontent.com
  github:
    branch: main
    deploy_on_push: true
    repo: bestskyamerican/taxsky_ai
  name: taxsky-ai-frontend
  output_dir: dist
  source_dir: /frontend
